const appid = '2FE3046334164371B711F64CEAA3BC2C';
const vn = '2.2.0';
const vc = '';
const TDBaseUrl = 'https://jic.talkingdata.com/app/h5/v1/websdk';
const TDRequestUrl = 'https://h5.udrig.com/app/v1';

window.storage = utools.dbStorage || localStorage || sessionStorage;

window["TDAPP"] = {};
window["TDAPP"].onEvent = function (id, label, params) {
    if (arguments.length > 0) {
        try {
            const opts = {count: 1, start: new Date().getTime()};
            if (id !== undefined) {
                opts["id"] = typeof id != "string" ? JSON.stringify(id) : id
            }
            if (label !== undefined) {
                opts["label"] = typeof label != "string" ? JSON.stringify(label) : label
            } else {
                opts["label"] = ""
            }
            if (params !== undefined) {
                const isJson = function (obj) {
                    return typeof (obj) == "object" && Object.prototype.toString.call(obj).toLowerCase() === "[object object]" && !obj.length
                };
                if (isJson(params)) {
                    opts["params"] = params
                } else {
                    opts["params"] = {params: ""}
                }
            }
            const eventName = "__TD_td-init-event";
            const ev = window.storage.getItem(eventName);
            if (ev) {
                const ca = JSON.parse(ev);
                ca.push(opts);
                window.storage.setItem(eventName, JSON.stringify(ca));
                return
            }
            window.storage.setItem(eventName, "[" + JSON.stringify(opts) + "]")
        } catch (e) {
        }
    }
};
